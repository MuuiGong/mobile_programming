# RÂ² ì°¨íŠ¸ êµ¬í˜„ í”„ë¡¬í”„íŠ¸ â€” ì •í™•í•œ ë¼ì¸ ë¼ë²¨ ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼

## ğŸ¯ í•µì‹¬ ëª©í‘œ

> **ì¤‘ìš”:** ë¼ì¸ ë¼ë²¨(**TP, Entry, SL**)ì´ **ì°¨íŠ¸ ìœ„ì— í¬ê²Œ ì˜¤ë²„ë ˆì´**ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
> ê° ë¼ë²¨ì€:
> - ë¼ì¸ì˜ **ì™¼ìª½ì— í° í…ìŠ¤íŠ¸** (ë°°ê²½ ë°•ìŠ¤ í¬í•¨)
> - ë¼ì¸ì˜ **ì˜¤ë¥¸ìª½ì— í˜„ì¬ ê°€ê²©** (ìš°ì¸¡ ì •ë ¬)
> - ë¼ì¸ ìƒ‰ìƒê³¼ ì¼ì¹˜í•˜ëŠ” ë°°ê²½ (TP=ì´ˆë¡, Entry=íšŒìƒ‰, SL=ë¹¨ê°•)

---

## ğŸ“ ì´ë¯¸ì§€ ë¶„ì„ (ì •í™•í•œ ìŠ¤í™)

### 1. ì°¨íŠ¸ ë ˆì´ì•„ì›ƒ
- ì „ì²´ í™”ë©´ì˜ **65-70%ê°€ ì°¨íŠ¸**
- ë°°ê²½: ê²€ì • (#0D1117)
- ìº”ë“¤ìŠ¤í‹± ê¸°ë³¸ TradingView ìŠ¤íƒ€ì¼

### 2. ë¼ì¸ ë¼ë²¨ (ë§¤ìš° ì¤‘ìš”!)

#### ì™¼ìª½ ë¼ë²¨ ë°•ìŠ¤
- **ìœ„ì¹˜:** ë¼ì¸ì˜ ì™¼ìª½, ì°¨íŠ¸ ì˜ì—­ ë‚´ë¶€
- **í¬ê¸°:** ì•½ 120px x 28px (í¬ê³  ëˆˆì— ë„ê²Œ)
- **ë°°ê²½ìƒ‰:** 
  - TP = `#00C853` (ì´ˆë¡)
  - Entry = `#9E9E9E` (íšŒìƒ‰)
  - SL = `#FF1744` (ë¹¨ê°•)
- **í…ìŠ¤íŠ¸:** 
  - í°ìƒ‰, **Bold, 13-14sp**
  - í˜•ì‹: `TP: $97707.79` / `Entry: $95720.00` / `SL: $93876.11`
- **ëª¨ì„œë¦¬:** ì•½ 4-6dp ë‘¥ê¸€ê²Œ
- **íŒ¨ë”©:** ìƒí•˜ 4px, ì¢Œìš° 8px

#### ì˜¤ë¥¸ìª½ ê°€ê²© í‘œì‹œ
- **ìœ„ì¹˜:** ë¼ì¸ì˜ ì˜¤ë¥¸ìª½ ë, ì°¨íŠ¸ ìš°ì¸¡
- **í˜•ì‹:** ê°€ê²©ë§Œ í‘œì‹œ (ì˜ˆ: `97707.79`)
- **í¬ê¸°:** ì•½ 70-80px x 24px
- **ë°°ê²½:** ë¼ì¸ê³¼ ê°™ì€ ìƒ‰ìƒ (ë°˜íˆ¬ëª… 20%)
- **í…ìŠ¤íŠ¸:** í°ìƒ‰, Bold, 12-13sp
- **ì˜¤ë¥¸ìª½ ì •ë ¬**

### 3. ë¼ì¸ ìì²´
- **ë‘ê»˜:** 2-3px (ì„ ëª…í•¨)
- **ìƒ‰ìƒ:** 
  - TP = `#00C853` (ì´ˆë¡)
  - Entry = `#9E9E9E` (íšŒìƒ‰)
  - SL = `#FF1744` (ë¹¨ê°•)
- **ìŠ¤íƒ€ì¼:** ì‹¤ì„  (ë“œë˜ê·¸ ì¤‘ ì ì„ )

### 4. ì˜ì—­ ìƒ‰ìƒí™”
- **Entry-TP ì‚¬ì´:** `rgba(0, 200, 83, 0.25)` (ì´ˆë¡, 25% íˆ¬ëª…ë„)
- **Entry-SL ì‚¬ì´:** `rgba(255, 23, 68, 0.25)` (ë¹¨ê°•, 25% íˆ¬ëª…ë„)
- **ë©´ì ì´ í¬ê²Œ í‘œì‹œë¨** (R:R ì‹œê°í™”)

### 5. ìš°ìƒë‹¨ ì •ë³´ íŒ¨ë„
- **ìœ„ì¹˜:** ìš°ìƒë‹¨ ëª¨ì„œë¦¬
- **í¬ê¸°:** ì•½ 140px x 150px (ì‘ê³  ê°„ê²°)
- **ë°°ê²½:** `rgba(0, 0, 0, 0.8)`
- **ë‚´ìš©:**
  ```
  Entry:  $95720.00
  TP:     $97707.79
  SL:     $93876.11
  R:R:    1.08
  P&L:    +78.59 USDT
  ìœ„í—˜ë„:  Low
  ```
- **í…ìŠ¤íŠ¸ í¬ê¸°:** 10-11sp
- **ìƒ‰ìƒ:** í°ìƒ‰/íšŒìƒ‰

### 6. í•˜ë‹¨ R:R ë¹„ìœ¨ ì¹´ë“œ
- **ìœ„ì¹˜:** ì°¨íŠ¸ ì•„ë˜, ë³„ë„ ì¹´ë“œ
- **í¬ê¸°:** ì „ì²´ ë„ˆë¹„, ì•½ 60dp ë†’ì´
- **ë°°ê²½:** `#1C1F26`
- **í‘œì‹œ:** 
  - ì™¼ìª½: "R:R ë¹„ìœ¨" (íšŒìƒ‰ í…ìŠ¤íŠ¸)
  - ì˜¤ë¥¸ìª½: `R:R 1.08:1` (ì˜¤ë Œì§€ìƒ‰, **24sp Bold**)

---

## ğŸ”§ êµ¬í˜„ ê°€ì´ë“œ (ìƒì„¸)

### A. HTML/JavaScript (ì°¨íŠ¸ ë¼ì¸ ë¼ë²¨ ë Œë”ë§)

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RÂ² Trading Chart - Line Labels</title>
    <script src="https://unpkg.com/lightweight-charts@4/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #0D1117;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }

        #chartContainer {
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* ë¼ì¸ ë¼ë²¨ ìŠ¤íƒ€ì¼ (ì™¼ìª½ ë°•ìŠ¤) */
        .line-label-left {
            position: absolute;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: bold;
            color: white;
            z-index: 100;
            white-space: nowrap;
            user-select: none;
            cursor: grab;
            display: none;
        }

        .line-label-left.tp {
            background-color: #00C853;
        }

        .line-label-left.entry {
            background-color: #9E9E9E;
        }

        .line-label-left.sl {
            background-color: #FF1744;
        }

        /* ì˜¤ë¥¸ìª½ ê°€ê²© í‘œì‹œ */
        .line-label-right {
            position: absolute;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            z-index: 100;
            white-space: nowrap;
            user-select: none;
            display: none;
        }

        .line-label-right.tp {
            background-color: rgba(0, 200, 83, 0.6);
        }

        .line-label-right.entry {
            background-color: rgba(158, 158, 158, 0.6);
        }

        .line-label-right.sl {
            background-color: rgba(255, 23, 68, 0.6);
        }

        /* ë“œë˜ê·¸ ì¤‘ ìƒíƒœ */
        .line-label-left.dragging,
        .line-label-right.dragging {
            opacity: 1;
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

        /* ê°€ê²© íˆ´íŒ */
        .price-tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: bold;
            display: none;
            z-index: 150;
            pointer-events: none;
            border: 1px solid #666;
        }

        /* ìš°ìƒë‹¨ ì •ë³´ íŒ¨ë„ */
        .info-panel {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.85);
            border: 1px solid #424242;
            border-radius: 8px;
            padding: 12px;
            color: white;
            font-size: 10px;
            z-index: 95;
            font-family: monospace;
            line-height: 1.8;
            max-width: 160px;
        }

        .info-panel .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .info-panel .label {
            color: #9E9E9E;
            margin-right: 8px;
        }

        .info-panel .value {
            color: white;
            font-weight: bold;
            text-align: right;
            flex-grow: 1;
        }

        .info-panel .value.positive {
            color: #00C853;
        }

        .info-panel .value.negative {
            color: #FF1744;
        }

        .info-panel .value.orange {
            color: #FF9800;
        }
    </style>
</head>
<body>
    <div id="chartContainer">
        <div class="info-panel" id="infoPanel"></div>
        <div class="line-label-left tp" id="tpLabelLeft"></div>
        <div class="line-label-left entry" id="entryLabelLeft"></div>
        <div class="line-label-left sl" id="slLabelLeft"></div>
        <div class="line-label-right tp" id="tpLabelRight"></div>
        <div class="line-label-right entry" id="entryLabelRight"></div>
        <div class="line-label-right sl" id="slLabelRight"></div>
        <div class="price-tooltip" id="priceTooltip"></div>
    </div>

    <script>
        // ========== ì°¨íŠ¸ ì´ˆê¸°í™” ==========
        const container = document.getElementById('chartContainer');
        const chart = LightweightCharts.createChart(container, {
            layout: {
                background: { color: '#0D1117' },
                textColor: '#BDBDBD',
            },
            grid: {
                vertLines: { color: '#1C1F26' },
                horzLines: { color: '#1C1F26' },
            },
            timeScale: {
                timeVisible: true,
                borderColor: '#2C2F36',
            },
            rightPriceScale: {
                borderColor: '#2C2F36',
            },
            width: container.offsetWidth,
            height: container.offsetHeight,
        });

        const candleSeries = chart.addCandlestickSeries({
            upColor: '#26a69a',
            downColor: '#ef5350',
        });

        // ìƒ˜í”Œ ë°ì´í„°
        const data = generateCandleData();
        candleSeries.setData(data);
        chart.timeScale().fitContent();

        // ========== ë¼ì¸ ë°ì´í„° ==========
        let lineData = {
            entry: 95720.00,
            tp: 97707.79,
            sl: 93876.11,
        };

        let lineSeries = {
            entry: null,
            tp: null,
            sl: null,
        };

        let areaSeriesList = [];

        // ========== ë“œë˜ê·¸ ìƒíƒœ ==========
        let isDragging = false;
        let draggingLineType = null;

        // ========== ë¼ì¸ ë Œë”ë§ ==========
        function renderLines() {
            // ê¸°ì¡´ ì œê±°
            if (lineSeries.entry) chart.removeSeries(lineSeries.entry);
            if (lineSeries.tp) chart.removeSeries(lineSeries.tp);
            if (lineSeries.sl) chart.removeSeries(lineSeries.sl);
            areaSeriesList.forEach(s => chart.removeSeries(s));
            areaSeriesList = [];

            // ì˜ì—­ ìƒ‰ìƒ
            const profitArea = chart.addAreaSeries({
                topColor: 'rgba(0, 200, 83, 0.25)',
                bottomColor: 'rgba(0, 200, 83, 0.05)',
                lineColor: 'transparent',
                lineWidth: 0,
            });
            profitArea.setData([
                { time: data[0].time, value: Math.max(lineData.tp, lineData.entry) },
                { time: data[data.length - 1].time, value: Math.max(lineData.tp, lineData.entry) },
                { time: data[data.length - 1].time, value: Math.min(lineData.tp, lineData.entry) },
                { time: data[0].time, value: Math.min(lineData.tp, lineData.entry) },
            ]);
            areaSeriesList.push(profitArea);

            const lossArea = chart.addAreaSeries({
                topColor: 'rgba(255, 23, 68, 0.25)',
                bottomColor: 'rgba(255, 23, 68, 0.05)',
                lineColor: 'transparent',
                lineWidth: 0,
            });
            lossArea.setData([
                { time: data[0].time, value: Math.max(lineData.entry, lineData.sl) },
                { time: data[data.length - 1].time, value: Math.max(lineData.entry, lineData.sl) },
                { time: data[data.length - 1].time, value: Math.min(lineData.entry, lineData.sl) },
                { time: data[0].time, value: Math.min(lineData.entry, lineData.sl) },
            ]);
            areaSeriesList.push(lossArea);

            // ë¼ì¸ ê·¸ë¦¬ê¸°
            const lineStyle = isDragging ? 1 : 0; // 0=ì‹¤ì„ , 1=ì ì„ 

            lineSeries.entry = chart.addLineSeries({
                color: '#9E9E9E',
                lineWidth: isDragging && draggingLineType === 'entry' ? 3 : 2,
                lineStyle: isDragging && draggingLineType === 'entry' ? 1 : 0,
            });
            lineSeries.entry.setData([
                { time: data[0].time, value: lineData.entry },
                { time: data[data.length - 1].time, value: lineData.entry },
            ]);

            lineSeries.tp = chart.addLineSeries({
                color: '#00C853',
                lineWidth: isDragging && draggingLineType === 'tp' ? 3 : 2,
                lineStyle: isDragging && draggingLineType === 'tp' ? 1 : 0,
            });
            lineSeries.tp.setData([
                { time: data[0].time, value: lineData.tp },
                { time: data[data.length - 1].time, value: lineData.tp },
            ]);

            lineSeries.sl = chart.addLineSeries({
                color: '#FF1744',
                lineWidth: isDragging && draggingLineType === 'sl' ? 3 : 2,
                lineStyle: isDragging && draggingLineType === 'sl' ? 1 : 0,
            });
            lineSeries.sl.setData([
                { time: data[0].time, value: lineData.sl },
                { time: data[data.length - 1].time, value: lineData.sl },
            ]);

            updateLabels();
            updateInfoPanel();
        }

        // ========== ë¼ë²¨ ìœ„ì¹˜ ì—…ë°ì´íŠ¸ ==========
        function updateLabels() {
            const entryY = chart.priceToCoordinate(lineData.entry);
            const tpY = chart.priceToCoordinate(lineData.tp);
            const slY = chart.priceToCoordinate(lineData.sl);

            // Entry ë¼ë²¨
            if (entryY !== null) {
                updateLabel('entry', entryY, lineData.entry);
            }

            // TP ë¼ë²¨
            if (tpY !== null) {
                updateLabel('tp', tpY, lineData.tp);
            }

            // SL ë¼ë²¨
            if (slY !== null) {
                updateLabel('sl', slY, lineData.sl);
            }
        }

        function updateLabel(type, y, price) {
            const leftLabel = document.getElementById(`${type}LabelLeft`);
            const rightLabel = document.getElementById(`${type}LabelRight`);

            // ì™¼ìª½ ë¼ë²¨
            leftLabel.textContent = `${type.toUpperCase()}: $${price.toFixed(2)}`;
            leftLabel.style.top = (y - 14) + 'px';
            leftLabel.style.left = '10px';
            leftLabel.style.display = 'block';

            // ì˜¤ë¥¸ìª½ ë¼ë²¨
            const chartWidth = container.offsetWidth;
            rightLabel.textContent = price.toFixed(2);
            rightLabel.style.top = (y - 12) + 'px';
            rightLabel.style.right = '10px';
            rightLabel.style.display = 'block';
        }

        // ========== ì •ë³´ íŒ¨ë„ ì—…ë°ì´íŠ¸ ==========
        function updateInfoPanel() {
            const rrRatio = (lineData.tp - lineData.entry) / (lineData.entry - lineData.sl);
            const pnlValue = 100; // ì˜ˆì‹œ

            const html = `
                <div class="info-row">
                    <span class="label">Entry:</span>
                    <span class="value">$${lineData.entry.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="label">TP:</span>
                    <span class="value">$${lineData.tp.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="label">SL:</span>
                    <span class="value">$${lineData.sl.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="label">R:R:</span>
                    <span class="value orange">${rrRatio.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="label">P&amp;L:</span>
                    <span class="value positive">+${pnlValue.toFixed(2)} USDT</span>
                </div>
                <div class="info-row">
                    <span class="label">ìœ„í—˜ë„:</span>
                    <span class="value">Low</span>
                </div>
            `;

            document.getElementById('infoPanel').innerHTML = html;
        }

        // ========== ë“œë˜ê·¸ í•¸ë“¤ëŸ¬ ==========
        container.addEventListener('mousedown', startDrag);
        container.addEventListener('touchstart', startDrag);

        function startDrag(e) {
            const y = getEventY(e);
            const price = chart.coordinateToPrice(y);

            if (!price) return;

            const threshold = Math.abs(lineData.entry) * 0.001;

            if (Math.abs(price - lineData.tp) < threshold) {
                isDragging = true;
                draggingLineType = 'tp';
                document.getElementById('tpLabelLeft').classList.add('dragging');
                document.getElementById('tpLabelRight').classList.add('dragging');
            } else if (Math.abs(price - lineData.sl) < threshold) {
                isDragging = true;
                draggingLineType = 'sl';
                document.getElementById('slLabelLeft').classList.add('dragging');
                document.getElementById('slLabelRight').classList.add('dragging');
            } else if (Math.abs(price - lineData.entry) < threshold) {
                isDragging = true;
                draggingLineType = 'entry';
                document.getElementById('entryLabelLeft').classList.add('dragging');
                document.getElementById('entryLabelRight').classList.add('dragging');
            }

            if (isDragging) {
                renderLines();
            }
        }

        document.addEventListener('mousemove', handleDrag);
        document.addEventListener('touchmove', handleDrag);

        function handleDrag(e) {
            if (!isDragging || !draggingLineType) return;

            const y = getEventY(e);
            const price = chart.coordinateToPrice(y);

            if (price) {
                lineData[draggingLineType] = price;

                // íˆ´íŒ
                const tooltip = document.getElementById('priceTooltip');
                tooltip.textContent = `$${price.toFixed(2)}`;
                tooltip.style.top = (y - 30) + 'px';
                const clientX = e.clientX || e.touches?.[0]?.clientX || 0;
                tooltip.style.left = (clientX + 20) + 'px';
                tooltip.style.display = 'block';

                renderLines();

                // Android ì•Œë¦¼
                if (window.AndroidBridge) {
                    window.AndroidBridge.onLineUpdated(draggingLineType, price);
                }
            }
        }

        document.addEventListener('mouseup', endDrag);
        document.addEventListener('touchend', endDrag);

        function endDrag() {
            if (isDragging) {
                isDragging = false;
                document.querySelectorAll('.dragging').forEach(el => el.classList.remove('dragging'));
                document.getElementById('priceTooltip').style.display = 'none';
                draggingLineType = null;
                renderLines();
            }
        }

        function getEventY(e) {
            const rect = container.getBoundingClientRect();
            if (e.touches) return e.touches[0].clientY - rect.top;
            return e.clientY - rect.top;
        }

        // ========== Android ì¸í„°í˜ì´ìŠ¤ ==========
        window.updateLines = function(entry, tp, sl) {
            lineData.entry = entry;
            lineData.tp = tp;
            lineData.sl = sl;
            renderLines();
        };

        // ========== ì´ˆê¸°í™” ë° ë¦¬ì‚¬ì´ì¦ˆ ==========
        renderLines();

        window.addEventListener('resize', () => {
            chart.applyOptions({
                width: container.offsetWidth,
                height: container.offsetHeight,
            });
            updateLabels();
        });

        if (window.AndroidBridge) {
            window.AndroidBridge.ready();
        }

        // ========== ìƒ˜í”Œ ë°ì´í„° ==========
        function generateCandleData() {
            const basePrice = 95000;
            const result = [];
            const now = Math.floor(Date.now() / 1000);

            for (let i = 0; i < 200; i++) {
                const time = now - (200 - i) * 3600;
                const volatility = Math.random() * 2000 - 1000;
                const open = basePrice + volatility;
                const close = open + (Math.random() * 1500 - 750);
                const high = Math.max(open, close) + Math.random() * 800;
                const low = Math.min(open, close) - Math.random() * 800;

                result.push({ time, open, high, low, close });
            }

            return result;
        }
    </script>
</body>
</html>
```

---

## ğŸ“‹ í•µì‹¬ íŠ¹ì§• ìš”ì•½

1. âœ… **ì™¼ìª½ì— í° ë¼ë²¨ ë°•ìŠ¤**
   - í˜•ì‹: `TP: $97707.79`
   - í¬ê¸°: 120px x 28px
   - ìƒ‰ìƒ: ë¼ì¸ê³¼ ì¼ì¹˜

2. âœ… **ì˜¤ë¥¸ìª½ì— ê°€ê²© í‘œì‹œ**
   - í˜•ì‹: `97707.79` (ìˆ«ìë§Œ)
   - ìš°ì¸¡ ì •ë ¬

3. âœ… **ì˜ì—­ ìƒ‰ìƒí™”**
   - Entry-TP: ì´ˆë¡ ë°˜íˆ¬ëª… (25%)
   - Entry-SL: ë¹¨ê°• ë°˜íˆ¬ëª… (25%)

4. âœ… **ìš°ìƒë‹¨ ì‘ì€ ì •ë³´ íŒ¨ë„**
   - 140x150px ì •ë„
   - ì°¨íŠ¸ë¥¼ ê°€ë¦¬ì§€ ì•ŠìŒ

5. âœ… **ë“œë˜ê·¸ ì¤‘ ì ì„  + íˆ´íŒ**
   - ë¶€ë“œëŸ¬ìš´ ì¸í„°ë™ì…˜

6. âœ… **í•˜ë‹¨ R:R ë¹„ìœ¨ ì¹´ë“œ**
   - `R:R 1.08:1` (ì˜¤ë Œì§€, 24sp)

