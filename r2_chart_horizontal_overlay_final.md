# RÂ² ì°¨íŠ¸ êµ¬í˜„ í”„ë¡¬í”„íŠ¸ â€” TradingView ìŠ¤íƒ€ì¼ ê°€ë¡œ ì˜¤ë²„ë ˆì´ TP/SL ì»¨íŠ¸ë¡¤

## ğŸ¯ í•µì‹¬ ìš”êµ¬ì‚¬í•­ (ì •í™•í•¨!)

> **ì¤‘ìš”:** ì°¨íŠ¸ ìœ„ì— **ê°€ë¡œë¡œ í•œ ì¤„**ë¡œ í‘œì‹œë˜ëŠ” **TP/SL ì»¨íŠ¸ë¡¤ ë°”**ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.
> - Entry(1L), TP, SL ë²„íŠ¼ì´ **ê°™ì€ ìˆ˜í‰ì„  ìœ„ì—** í‘œì‹œ
> - **ê°€ë¡œ ë¼ì¸ì´ ìˆ˜ì§ìœ¼ë¡œ ë“œë˜ê·¸ ê°€ëŠ¥** (ìœ„ì•„ë˜ë¡œ ì´ë™)
> - ë“œë˜ê·¸í•˜ë©´ í•´ë‹¹ ë¼ì¸ê³¼ ë²„íŠ¼ì´ í•¨ê»˜ ì›€ì§ì„
> - TradingView ì°¨íŠ¸ì²˜ëŸ¼ ê¹”ë”í•œ ìŠ¤íƒ€ì¼

---

## ğŸ“ ë””ìì¸ ë¶„ì„

### í•µì‹¬ êµ¬ì¡°

```
ì°¨íŠ¸ ìœ„ì—:

â”Œâ”€ ê°€ë¡œ ì˜¤ë Œì§€ ì ì„  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [1L]  [TP]  [SL]  [-1]  [-0.11 USD]  [X]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ìœ„/ì•„ë˜ë¡œ ë“œë˜ê·¸ ê°€ëŠ¥

íŠ¹ì§•:
- ê°€ë¡œë¡œ í•œ ì¤„ ì •ë ¬
- ë°°ê²½: ë°˜íˆ¬ëª… (ê²€ì • ë˜ëŠ” ì•½ê°„ì˜ ë°°ê²½)
- í…Œë‘ë¦¬: ì˜¤ë Œì§€ ì ì„ 
- ë²„íŠ¼ë“¤ì´ í•¨ê»˜ ì›€ì§ì„
```

### ìƒì„¸ ìŠ¤í™

#### 1. ì»¨íŠ¸ë¡¤ ë°” (ê°€ë¡œ ì˜¤ë²„ë ˆì´)
- **ìœ„ì¹˜:** ì°¨íŠ¸ ìœ„ì— ë¶€ë™ (ê°€ë¡œ ì¤‘ì•™ ì •ë ¬)
- **ë†’ì´:** ì•½ 32-36px
- **ë„ˆë¹„:** ì•½ 500-600px (ë‚´ìš©ì— ë”°ë¼ ìë™)
- **ë°°ê²½:** `rgba(0, 0, 0, 0.3)` (ë§¤ìš° íˆ¬ëª…)
- **í…Œë‘ë¦¬:** 
  - ìƒ‰ìƒ: `#FF9800` (ì˜¤ë Œì§€)
  - ìŠ¤íƒ€ì¼: **ì ì„ ** (dashed)
  - ë‘ê»˜: 2px
- **ëª¨ì„œë¦¬:** ì•½ê°„ ë‘¥ê¸€ê²Œ (6-8dp radius)
- **íŒ¨ë”©:** ì¢Œìš° 12px, ìƒí•˜ 6px
- **ë“œë˜ê·¸ ê°€ëŠ¥:** **Yì¶•ë§Œ** (ìœ„ì•„ë˜)

#### 2. ë²„íŠ¼ë“¤ (ê°€ë¡œ ì •ë ¬)

##### 2.1 Entry ë²„íŠ¼ (1L)
- **ë¼ë²¨:** "1L"
- **ë°°ê²½ìƒ‰:** `#9E9E9E` (íšŒìƒ‰)
- **í…ìŠ¤íŠ¸ìƒ‰:** í°ìƒ‰
- **í¬ê¸°:** ì•½ 32-36px (ì •ì‚¬ê°í˜•)
- **ëª¨ì„œë¦¬:** 4dp ë‘¥ê¸€ê²Œ
- **í°íŠ¸:** Bold, 12sp

##### 2.2 TP ë²„íŠ¼
- **ë¼ë²¨:** "TP"
- **ë°°ê²½ìƒ‰:** `#26a69a` (ì´ˆë¡)
- **í…ìŠ¤íŠ¸ìƒ‰:** í°ìƒ‰
- **í¬ê¸°:** ì•½ 40px x 32px
- **ëª¨ì„œë¦¬:** 4dp ë‘¥ê¸€ê²Œ
- **í°íŠ¸:** Bold, 12sp

##### 2.3 SL ë²„íŠ¼
- **ë¼ë²¨:** "SL"
- **ë°°ê²½ìƒ‰:** `#EF5350` (ë¹¨ê°•)
- **í…ìŠ¤íŠ¸ìƒ‰:** í°ìƒ‰
- **í¬ê¸°:** ì•½ 40px x 32px
- **ëª¨ì„œë¦¬:** 4dp ë‘¥ê¸€ê²Œ
- **í°íŠ¸:** Bold, 12sp

#### 3. ìˆ˜ìµ/ì†ì‹¤ í‘œì‹œ
- **í˜•ì‹:** "[-1]  [-0.11 USD]" 
- **ìœ„ì¹˜:** TP/SL ë²„íŠ¼ ì˜¤ë¥¸ìª½
- **í…ìŠ¤íŠ¸ìƒ‰:** 
  - ì–‘ìˆ˜(ìˆ˜ìµ): `#26a69a` (ì´ˆë¡)
  - ìŒìˆ˜(ì†ì‹¤): `#EF5350` (ë¹¨ê°•)
- **í°íŠ¸:** Regular, 12sp

#### 4. ë‹«ê¸° ë²„íŠ¼ (X)
- **ìœ„ì¹˜:** ë§¨ ì˜¤ë¥¸ìª½
- **í¬ê¸°:** 24x24px
- **ì•„ì´ì½˜:** X
- **ë°°ê²½ìƒ‰:** `rgba(255, 255, 255, 0.1)`
- **í˜¸ë²„ ì‹œ:** ë°°ê²½ìƒ‰ ë³€ê²½

### ë¼ì¸ ì‹œê°í™”

#### ê°€ë¡œ ì ì„  (ì˜¤ë Œì§€)
- ì»¨íŠ¸ë¡¤ ë°” ìˆ˜í‰ì„ ì„ ë”°ë¼ ì°¨íŠ¸ ì „ì²´ ë„ˆë¹„ í‘œì‹œ
- ìƒ‰ìƒ: `#FF9800` (ì˜¤ë Œì§€)
- ìŠ¤íƒ€ì¼: **ì ì„ ** (dashed)
- ë‘ê»˜: 2px

#### ìˆ˜ì§ ë¼ì¸ (ê° ë¼ì¸)
- **Entry ìœ„ì¹˜:** íšŒìƒ‰ ìˆ˜ì§ì„  (ë“œë˜ê·¸í•˜ë©´ í•¨ê»˜ ì´ë™)
- **TP ìœ„ì¹˜:** ì´ˆë¡ ìˆ˜ì§ì„ 
- **SL ìœ„ì¹˜:** ë¹¨ê°• ìˆ˜ì§ì„ 
- **ìŠ¤íƒ€ì¼:** ì‹¤ì„ , 1px, ì•½ê°„ íˆ¬ëª…

---

## ğŸ”§ HTML/JavaScript êµ¬í˜„

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RÂ² Chart - TradingView Style</title>
    <script src="https://unpkg.com/lightweight-charts@4/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #1A1F2E;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
        }

        #chartContainer {
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* TP/SL ì»¨íŠ¸ë¡¤ ë°” */
        .tp-sl-bar {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.3);
            border: 2px dashed #FF9800;
            border-radius: 8px;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 100;
            cursor: grab;
            user-select: none;
            left: 50%;
            transform: translateX(-50%);
            top: 100px;
        }

        .tp-sl-bar:active {
            cursor: grabbing;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .tp-sl-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 40px;
            height: 32px;
            transition: all 0.2s ease;
        }

        .tp-sl-btn:hover {
            opacity: 0.9;
            transform: scale(1.05);
        }

        .tp-sl-btn.entry {
            background-color: #9E9E9E;
            min-width: 36px;
        }

        .tp-sl-btn.tp {
            background-color: #26a69a;
        }

        .tp-sl-btn.sl {
            background-color: #EF5350;
        }

        /* PnL í‘œì‹œ */
        .pnl-display {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-left: 8px;
            font-size: 12px;
            font-weight: 500;
            color: #E1E8ED;
        }

        .pnl-value {
            color: #EF5350;
        }

        .pnl-value.positive {
            color: #26a69a;
        }

        /* ë‹«ê¸° ë²„íŠ¼ */
        .close-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 4px;
            width: 28px;
            height: 28px;
            color: #E1E8ED;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: background-color 0.2s;
        }

        .close-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* ìˆ˜í‰ ì ì„  */
        .horizontal-line {
            position: absolute;
            height: 2px;
            border-bottom: 2px dashed #FF9800;
            width: 100%;
            pointer-events: none;
            z-index: 50;
        }

        /* ìˆ˜ì§ ë¼ì¸ë“¤ */
        svg.vertical-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 40;
        }

        /* ì •ë³´ íŒ¨ë„ */
        .info-panel {
            position: absolute;
            top: 12px;
            right: 12px;
            background-color: rgba(0, 0, 0, 0.6);
            border: 1px solid #303641;
            border-radius: 6px;
            padding: 12px;
            color: #E1E8ED;
            font-size: 11px;
            z-index: 95;
            line-height: 1.8;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .info-label {
            color: #888;
            margin-right: 12px;
        }

        .info-value {
            color: #E1E8ED;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div id="chartContainer">
        <svg class="vertical-lines" id="verticalLines"></svg>
        <div class="horizontal-line" id="horizontalLine"></div>
        <div class="tp-sl-bar" id="tpSlBar">
            <button class="tp-sl-btn entry" id="entryBtn">1L</button>
            <button class="tp-sl-btn tp" id="tpBtn">TP</button>
            <button class="tp-sl-btn sl" id="slBtn">SL</button>
            <div class="pnl-display">
                <span id="pnlValue" class="pnl-value">-1</span>
                <span id="pnlUsd">-0.11 USD</span>
            </div>
            <button class="close-btn" id="closeBtn">Ã—</button>
        </div>
        <div class="info-panel" id="infoPanel"></div>
    </div>

    <script>
        // ========== ì°¨íŠ¸ ì´ˆê¸°í™” ==========
        const container = document.getElementById('chartContainer');
        const chart = LightweightCharts.createChart(container, {
            layout: {
                background: { color: '#1A1F2E' },
                textColor: '#D1D5DB',
            },
            grid: {
                vertLines: { color: '#2D3139' },
                horzLines: { color: '#2D3139' },
            },
            timeScale: {
                timeVisible: true,
                borderColor: '#3F4751',
            },
            rightPriceScale: {
                borderColor: '#3F4751',
            },
            width: container.offsetWidth,
            height: container.offsetHeight,
        });

        const candleSeries = chart.addCandlestickSeries({
            upColor: '#26a69a',
            downColor: '#ef5350',
        });

        const data = generateCandleData();
        candleSeries.setData(data);
        chart.timeScale().fitContent();

        // ========== ë¼ì¸ ë°ì´í„° ==========
        let lineData = {
            entry: 35000,
            tp: 36500,
            sl: 33500,
        };

        let lineSeries = {
            entry: null,
            tp: null,
            sl: null,
        };

        let areaSeriesList = [];

        // ========== ì»¨íŠ¸ë¡¤ ë°” ë“œë˜ê·¸ ==========
        const tpSlBar = document.getElementById('tpSlBar');
        let isDragging = false;
        let dragStartY = 0;
        let dragStartPrice = 0;

        tpSlBar.addEventListener('mousedown', startDrag);
        tpSlBar.addEventListener('touchstart', startDrag);

        function startDrag(e) {
            isDragging = true;
            dragStartY = e.clientY || e.touches[0].clientY;
            dragStartPrice = lineData.entry;
        }

        document.addEventListener('mousemove', handleDrag);
        document.addEventListener('touchmove', handleDrag);

        function handleDrag(e) {
            if (!isDragging) return;

            const currentY = e.clientY || e.touches[0].clientY;
            const deltaY = currentY - dragStartY;

            // Y í”½ì…€ ë³€í™˜ (ëŒ€ëµ 1px = 10 ê°€ê²© ë‹¨ìœ„)
            const priceChange = -deltaY * 10;
            const newEntryPrice = dragStartPrice + priceChange;

            // ë¼ì¸ ë°ì´í„° ì—…ë°ì´íŠ¸
            const priceDiff = lineData.entry - newEntryPrice;
            lineData.entry = newEntryPrice;
            lineData.tp -= priceDiff;
            lineData.sl -= priceDiff;

            renderLines();

            // Android ì•Œë¦¼
            if (window.AndroidBridge) {
                window.AndroidBridge.onLineUpdated('entry', lineData.entry);
            }
        }

        document.addEventListener('mouseup', endDrag);
        document.addEventListener('touchend', endDrag);

        function endDrag() {
            isDragging = false;
        }

        // ========== ë¼ì¸ ë Œë”ë§ ==========
        function renderLines() {
            // ê¸°ì¡´ ì œê±°
            Object.values(lineSeries).forEach(s => {
                if (s) chart.removeSeries(s);
            });
            areaSeriesList.forEach(s => chart.removeSeries(s));
            areaSeriesList = [];

            // ì˜ì—­ ìƒ‰ìƒí™”
            // TP-Entry ì´ˆë¡ ì˜ì—­
            const profitArea = chart.addAreaSeries({
                topColor: 'rgba(38, 166, 154, 0.15)',
                bottomColor: 'rgba(38, 166, 154, 0.05)',
                lineColor: 'transparent',
                lineWidth: 0,
            });
            profitArea.setData([
                { time: data[0].time, value: lineData.tp },
                { time: data[data.length - 1].time, value: lineData.tp },
                { time: data[data.length - 1].time, value: lineData.entry },
                { time: data[0].time, value: lineData.entry },
            ]);
            areaSeriesList.push(profitArea);

            // Entry-SL ë¹¨ê°• ì˜ì—­
            const lossArea = chart.addAreaSeries({
                topColor: 'rgba(239, 83, 80, 0.15)',
                bottomColor: 'rgba(239, 83, 80, 0.05)',
                lineColor: 'transparent',
                lineWidth: 0,
            });
            lossArea.setData([
                { time: data[0].time, value: lineData.entry },
                { time: data[data.length - 1].time, value: lineData.entry },
                { time: data[data.length - 1].time, value: lineData.sl },
                { time: data[0].time, value: lineData.sl },
            ]);
            areaSeriesList.push(lossArea);

            // TP ë¼ì¸
            lineSeries.tp = chart.addLineSeries({
                color: '#26a69a',
                lineWidth: 2,
            });
            lineSeries.tp.setData([
                { time: data[0].time, value: lineData.tp },
                { time: data[data.length - 1].time, value: lineData.tp },
            ]);

            // Entry ë¼ì¸
            lineSeries.entry = chart.addLineSeries({
                color: '#9E9E9E',
                lineWidth: 2,
            });
            lineSeries.entry.setData([
                { time: data[0].time, value: lineData.entry },
                { time: data[data.length - 1].time, value: lineData.entry },
            ]);

            // SL ë¼ì¸
            lineSeries.sl = chart.addLineSeries({
                color: '#EF5350',
                lineWidth: 2,
            });
            lineSeries.sl.setData([
                { time: data[0].time, value: lineData.sl },
                { time: data[data.length - 1].time, value: lineData.sl },
            ]);

            updateInfo();
            updateVerticalLines();
        }

        // ========== ìˆ˜ì§ ë¼ì¸ ê·¸ë¦¬ê¸° ==========
        function updateVerticalLines() {
            const svg = document.getElementById('verticalLines');
            svg.innerHTML = '';

            const entryY = chart.priceToCoordinate(lineData.entry);
            const tpY = chart.priceToCoordinate(lineData.tp);
            const slY = chart.priceToCoordinate(lineData.sl);
            const chartHeight = container.offsetHeight;

            if (entryY !== null) {
                drawVerticalLine(svg, entryY, '#9E9E9E', 'entry');
            }
            if (tpY !== null) {
                drawVerticalLine(svg, tpY, '#26a69a', 'tp');
            }
            if (slY !== null) {
                drawVerticalLine(svg, slY, '#EF5350', 'sl');
            }
        }

        function drawVerticalLine(svg, y, color, type) {
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', '0');
            line.setAttribute('y1', y);
            line.setAttribute('x2', svg.parentElement.offsetWidth);
            line.setAttribute('y2', y);
            line.setAttribute('stroke', color);
            line.setAttribute('stroke-width', '1');
            line.setAttribute('opacity', '0.3');
            line.setAttribute('stroke-dasharray', '4,4');
            svg.appendChild(line);
        }

        // ========== ì •ë³´ ì—…ë°ì´íŠ¸ ==========
        function updateInfo() {
            const rrRatio = (lineData.tp - lineData.entry) / (lineData.entry - lineData.sl);
            const pnl = lineData.tp - lineData.entry;
            const pnlPercent = (pnl / lineData.entry * 100).toFixed(2);

            // PnL í‘œì‹œ
            const pnlValueEl = document.getElementById('pnlValue');
            pnlValueEl.textContent = pnl >= 0 ? `+${pnlPercent}%` : `${pnlPercent}%`;
            pnlValueEl.className = pnl >= 0 ? 'pnl-value positive' : 'pnl-value';

            document.getElementById('pnlUsd').textContent = 
                `${pnl >= 0 ? '+' : ''}${pnl.toFixed(2)} USD`;

            // ì •ë³´ íŒ¨ë„
            const infoPanel = document.getElementById('infoPanel');
            infoPanel.innerHTML = `
                <div class="info-row">
                    <span class="info-label">Entry:</span>
                    <span class="info-value">$${lineData.entry.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">TP:</span>
                    <span class="info-value">$${lineData.tp.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">SL:</span>
                    <span class="info-value">$${lineData.sl.toFixed(2)}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">R:R:</span>
                    <span class="info-value">${rrRatio.toFixed(2)}</span>
                </div>
            `;
        }

        // ========== ë‹«ê¸° ë²„íŠ¼ ==========
        document.getElementById('closeBtn').addEventListener('click', () => {
            tpSlBar.style.display = 'none';
            document.getElementById('horizontalLine').style.display = 'none';
        });

        // ========== ì´ˆê¸°í™” ==========
        renderLines();

        window.addEventListener('resize', () => {
            chart.applyOptions({
                width: container.offsetWidth,
                height: container.offsetHeight,
            });
            updateVerticalLines();
        });

        // ========== Android ì¸í„°í˜ì´ìŠ¤ ==========
        window.updateLines = function(entry, tp, sl) {
            lineData.entry = entry;
            lineData.tp = tp;
            lineData.sl = sl;
            renderLines();
        };

        if (window.AndroidBridge) {
            window.AndroidBridge.ready();
        }

        // ========== ë°ì´í„° ìƒì„± ==========
        function generateCandleData() {
            const basePrice = 35000;
            const result = [];
            const now = Math.floor(Date.now() / 1000);

            for (let i = 0; i < 200; i++) {
                const time = now - (200 - i) * 3600;
                const volatility = Math.random() * 500 - 250;
                const open = basePrice + volatility;
                const close = open + (Math.random() * 300 - 150);
                const high = Math.max(open, close) + Math.random() * 200;
                const low = Math.min(open, close) - Math.random() * 200;

                result.push({ time, open, high, low, close });
            }

            return result;
        }
    </script>
</body>
</html>
```

---

## ğŸ“‹ í•µì‹¬ ê¸°ëŠ¥

âœ… **ê°€ë¡œ ì»¨íŠ¸ë¡¤ ë°”** - ì°¨íŠ¸ ìœ„ì— ê°€ë¡œë¡œ í•œ ì¤„ í‘œì‹œ
âœ… **ë“œë˜ê·¸ ê°€ëŠ¥** - Yì¶•ë§Œ ë“œë˜ê·¸ (ìœ„ì•„ë˜ ì´ë™)
âœ… **ë²„íŠ¼ í•¨ê»˜ ì´ë™** - Entry, TP, SL ë²„íŠ¼ì´ í•¨ê»˜ ì›€ì§ì„
âœ… **ìˆ˜í‰ ì ì„ ** - ì˜¤ë Œì§€ ì ì„ ìœ¼ë¡œ ìˆ˜í‰ í‘œì‹œ
âœ… **ìˆ˜ì§ ë¼ì¸** - ê° ë¼ì¸ì˜ ìˆ˜ì§ ìœ„ì¹˜ í‘œì‹œ
âœ… **ì •ë³´ íŒ¨ë„** - ìš°ìƒë‹¨ì— ì •ë³´ í‘œì‹œ
âœ… **TradingView ìŠ¤íƒ€ì¼** - ê¹”ë”í•œ ë””ìì¸

---

## ğŸš€ êµ¬í˜„ ë°©ë²•

1. ì´ HTMLì„ `assets/tradingview_chart.html`ë¡œ ì €ì¥
2. Android Activityì—ì„œ WebViewë¡œ ë¡œë“œ
3. JavaScriptInterfaceë¡œ `onLineUpdated()` ì—°ë™
4. ë²„íŠ¼ í´ë¦­ ì‹œ ì…ë ¥ê°’ ì—…ë°ì´íŠ¸

